# -*- coding: utf-8 -*-
"""
@Time    : 2025/12/09
@Author  : ZhangShenao
@File    : tools.py
@Desc    : Mock 工具定义 - 天气查询和火车票查询
"""

from langchain_core.tools import tool


# 模拟天气数据库
WEATHER_DB = {
    "北京": "晴，气温 -2°C ~ 8°C，北风3级，空气质量良好",
    "上海": "多云，气温 5°C ~ 12°C，东风2级，空气质量优",
    "广州": "阴转小雨，气温 15°C ~ 22°C，南风2级，空气质量良好",
    "深圳": "多云，气温 16°C ~ 23°C，东南风3级，空气质量优",
    "杭州": "晴转多云，气温 3°C ~ 14°C，西北风2级，空气质量良好",
    "成都": "阴，气温 8°C ~ 13°C，微风，空气质量轻度污染",
    "重庆": "小雨，气温 10°C ~ 14°C，东北风1级，空气质量良好",
    "西安": "晴，气温 -1°C ~ 9°C，西北风3级，空气质量中度污染",
    "南京": "多云，气温 2°C ~ 11°C，东风2级，空气质量良好",
    "武汉": "阴转多云，气温 4°C ~ 12°C，北风2级，空气质量良好",
    "天津": "晴，气温 -4°C ~ 6°C，西北风4级，空气质量良好",
    "苏州": "多云，气温 3°C ~ 12°C，东北风2级，空气质量优",
    "青岛": "晴，气温 0°C ~ 8°C，北风4级，空气质量优",
    "大连": "晴，气温 -5°C ~ 3°C，西北风5级，空气质量优",
    "厦门": "多云，气温 14°C ~ 20°C，东北风3级，空气质量优",
}


# 模拟火车票数据库 (出发城市, 目的城市) -> 票价信息
TICKET_DB = {
    ("北京", "上海"): "G1次 二等座 553元 | 一等座 933元 | 商务座 1748元，全程约4.5小时",
    ("上海", "北京"): "G2次 二等座 553元 | 一等座 933元 | 商务座 1748元，全程约4.5小时",
    ("北京", "广州"): "G79次 二等座 862元 | 一等座 1380元 | 商务座 2724元，全程约8小时",
    ("广州", "北京"): "G80次 二等座 862元 | 一等座 1380元 | 商务座 2724元，全程约8小时",
    ("上海", "杭州"): "G7501次 二等座 73元 | 一等座 117元 | 商务座 219元，全程约1小时",
    ("杭州", "上海"): "G7502次 二等座 73元 | 一等座 117元 | 商务座 219元，全程约1小时",
    ("北京", "天津"): "C2001次 二等座 54.5元 | 一等座 88元 | 商务座 174元，全程约30分钟",
    ("天津", "北京"): "C2002次 二等座 54.5元 | 一等座 88元 | 商务座 174元，全程约30分钟",
    ("广州", "深圳"): "G6201次 二等座 74.5元 | 一等座 99.5元 | 商务座 199元，全程约30分钟",
    ("深圳", "广州"): "G6202次 二等座 74.5元 | 一等座 99.5元 | 商务座 199元，全程约30分钟",
    ("成都", "重庆"): "G8601次 二等座 154元 | 一等座 247元 | 商务座 306元，全程约1.5小时",
    ("重庆", "成都"): "G8602次 二等座 154元 | 一等座 247元 | 商务座 306元，全程约1.5小时",
    ("上海", "南京"): "G7001次 二等座 134.5元 | 一等座 214.5元 | 商务座 399元，全程约1小时",
    ("南京", "上海"): "G7002次 二等座 134.5元 | 一等座 214.5元 | 商务座 399元，全程约1小时",
    ("北京", "西安"): "G87次 二等座 515.5元 | 一等座 824.5元 | 商务座 1628.5元，全程约4.5小时",
    ("西安", "北京"): "G88次 二等座 515.5元 | 一等座 824.5元 | 商务座 1628.5元，全程约4.5小时",
    ("杭州", "苏州"): "G7311次 二等座 78元 | 一等座 124元 | 商务座 232元，全程约1.5小时",
    ("苏州", "杭州"): "G7312次 二等座 78元 | 一等座 124元 | 商务座 232元，全程约1.5小时",
}


@tool
def get_weather(city: str) -> str:
    """
    查询指定城市的天气情况
    
    Args:
        city: 城市名称，如"北京"、"上海"、"广州"等
        
    Returns:
        该城市的天气信息，包括天气状况、温度、风向和空气质量
    """
    # 精确匹配
    if city in WEATHER_DB:
        return f"{city}天气：{WEATHER_DB[city]}"
    
    # 模糊匹配（处理带"市"的情况）
    city_without_suffix = city.replace("市", "")
    if city_without_suffix in WEATHER_DB:
        return f"{city_without_suffix}天气：{WEATHER_DB[city_without_suffix]}"
    
    # 未找到
    available_cities = "、".join(list(WEATHER_DB.keys())[:5]) + "等"
    return f"抱歉，未找到「{city}」的天气信息。目前支持查询的城市有：{available_cities}"


@tool
def get_train_ticket(from_city: str, to_city: str) -> str:
    """
    查询从出发城市到目的城市的火车票价格
    
    Args:
        from_city: 出发城市名称，如"北京"、"上海"等
        to_city: 目的城市名称，如"上海"、"广州"等
        
    Returns:
        火车票价格信息，包括不同座位等级的票价和行程时间
    """
    # 处理城市名称（去掉"市"后缀）
    from_city = from_city.replace("市", "")
    to_city = to_city.replace("市", "")
    
    # 精确匹配
    key = (from_city, to_city)
    if key in TICKET_DB:
        return f"{from_city} → {to_city} 火车票：{TICKET_DB[key]}"
    
    # 未找到直达车次
    available_routes = [f"{f} → {t}" for f, t in list(TICKET_DB.keys())[:5]]
    routes_str = "、".join(available_routes)
    return f"抱歉，未找到「{from_city} → {to_city}」的直达火车票信息。目前支持查询的热门线路有：{routes_str}等"


# 导出所有工具
ALL_TOOLS = [
    get_weather,
    get_train_ticket,
]

